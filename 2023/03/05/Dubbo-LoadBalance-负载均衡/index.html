<!DOCTYPE html>
<html lang="cn">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="liuchanglin">





<title>Dubbo LoadBalance è´Ÿè½½å‡è¡¡ | liuchanglin &#39;s blog</title>



    <link rel="icon" href="/img.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 7.3.0"></head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">LiuChanglin&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">LiuChanglin&#39;s Blog</a><a id="mobile-toggle-theme">Â·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">Dubbo LoadBalance è´Ÿè½½å‡è¡¡</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">liuchanglin</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">March 5, 2023&nbsp;&nbsp;16:50:53</a>
                        </span>
                    
                    
                </div>
            
        </header>

        <div class="post-content">
            <h2 id="ä¸€ã€è´Ÿè½½å‡è¡¡ç­–ç•¥æ¦‚è¿°"><a href="#ä¸€ã€è´Ÿè½½å‡è¡¡ç­–ç•¥æ¦‚è¿°" class="headerlink" title="ä¸€ã€è´Ÿè½½å‡è¡¡ç­–ç•¥æ¦‚è¿°"></a>ä¸€ã€è´Ÿè½½å‡è¡¡ç­–ç•¥æ¦‚è¿°</h2><p> å¤§éƒ¨åˆ†ä½¿ç”¨Dubboçš„äº’è”ç½‘åº”ç”¨ä¸­ï¼ŒæœåŠ¡æä¾›æ–¹åŸºæœ¬éƒ½æ˜¯ä»¥é›†ç¾¤çš„å½¢å¼æä¾›æ¥å£ï¼Œä¸ºäº†é¿å…å¤§é‡è¯·æ±‚ä¸€ç›´é›†ä¸­åœ¨ä¸€ä¸ªæˆ–è€…å‡ ä¸ªæœåŠ¡æä¾›æœºå™¨ä¸Šï¼Œä»è€Œä½¿è¿™äº›æœºå™¨è´Ÿè½½å‡é«˜æœ€åå½±å“æœåŠ¡å¥åº·çŠ¶æ€ï¼Œéœ€è¦åšä¸€å®šçš„è´Ÿè½½å‡è¡¡ç­–ç•¥ã€‚Dubboæä¾›äº†å¤šç§è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œé»˜è®¤ä¸º<strong><em>random</em></strong>ï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡éšæœºé€‰æ‹©ä¸€å°æœåŠ¡æä¾›è€…çš„æœåŠ¡ã€‚</p>
<p> Dubboæä¾›çš„è´Ÿè½½å‡è¡¡ç­–ç•¥æœ‰å¦‚ä¸‹å‡ ç§ï¼š</p>
<ul>
<li>RandomLoadBalance    éšæœºç­–ç•¥</li>
<li>RoundRobinLoadBalance è½®è¯¢ç­–ç•¥</li>
<li>LeastActiveLoadBalance æœ€å°‘æ´»è·ƒè°ƒç”¨æ•°</li>
<li>ConsistentHashLoadBalance ä¸€è‡´æ€§hashç­–ç•¥</li>
</ul>
<h2 id="äºŒã€RandomLoadBalance"><a href="#äºŒã€RandomLoadBalance" class="headerlink" title="äºŒã€RandomLoadBalance"></a>äºŒã€RandomLoadBalance</h2><p>  éšæœºç­–ç•¥æŒ‰ç…§æ¦‚ç‡è®¾ç½®æƒé‡ï¼Œæ¯”è¾ƒå‡åŒ€è€Œä¸”å¯ä»¥åŠ¨æ€è°ƒèŠ‚æä¾›è€…çš„æƒé‡ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> &lt;T&gt; Invoker&lt;T&gt; <span class="title function_">doSelect</span><span class="params">(List&lt;Invoker&lt;T&gt;&gt; invokers, URL url, Invocation invocation)</span> &#123;</span><br><span class="line">      <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> invokers.size(); <span class="comment">// è·å–ä¸ªæ•°</span></span><br><span class="line">      <span class="type">int</span> <span class="variable">totalWeight</span> <span class="operator">=</span> <span class="number">0</span>; <span class="comment">// The sum of weights</span></span><br><span class="line">      <span class="type">boolean</span> <span class="variable">sameWeight</span> <span class="operator">=</span> <span class="literal">true</span>; <span class="comment">// Every invoker has the same weight?</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">          <span class="comment">//è®¡ç®—æƒé‡</span></span><br><span class="line">          <span class="type">int</span> <span class="variable">weight</span> <span class="operator">=</span> getWeight(invokers.get(i), invocation);</span><br><span class="line">          totalWeight += weight; <span class="comment">// Sum</span></span><br><span class="line">          <span class="keyword">if</span> (sameWeight &amp;&amp; i &gt; <span class="number">0</span> <span class="comment">// ä¸ä¸‹ä¸€ä¸ªçš„invokerçš„æƒé‡ä¸ç›¸ç­‰</span></span><br><span class="line">                  &amp;&amp; weight != getWeight(invokers.get(i - <span class="number">1</span>), invocation)) &#123;</span><br><span class="line">              sameWeight = <span class="literal">false</span>;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// å½“æ‹¥æœ‰ä¸åŒæƒé‡çš„invokerçš„æ—¶å€™</span></span><br><span class="line">      <span class="keyword">if</span> (totalWeight &gt; <span class="number">0</span> &amp;&amp; !sameWeight) &#123;</span><br><span class="line">          <span class="comment">// If (not every invoker has the same weight &amp; at least one invoker&#x27;s weight&gt;0), </span></span><br><span class="line">        	<span class="comment">// select randomly based on totalWeight.</span></span><br><span class="line">          <span class="type">int</span> <span class="variable">offset</span> <span class="operator">=</span> random.nextInt(totalWeight);<span class="comment">// åœ¨æ‰€æœ‰æƒé‡ä¸­é€‰æ‹©ä¸€ä¸ª æ•°</span></span><br><span class="line">          <span class="comment">// Return a invoker based on the random value.</span></span><br><span class="line">          <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line"></span><br><span class="line">              <span class="comment">//ä½¿ç”¨ éšæœºå‡ºæ¥çš„è¿™ä¸ª offset - invokerçš„æƒé‡å€¼</span></span><br><span class="line">              offset -= getWeight(invokers.get(i), invocation);</span><br><span class="line">              <span class="keyword">if</span> (offset &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                  <span class="comment">// å°äº0 çš„æ—¶å€™å°±è¿”å›å½“å‰è¿™ä¸ªinvoker</span></span><br><span class="line">                  <span class="keyword">return</span> invokers.get(i);</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// If all invokers have the same weight value or totalWeight=0, return evenly.</span></span><br><span class="line">      <span class="comment">// åœ¨é›†åˆä¸‹æ ‡ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªä¸‹æ ‡</span></span><br><span class="line">      <span class="keyword">return</span> invokers.get(random.nextInt(length));</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p><code>length</code> è·å–æ‰€æœ‰invokerä¸ªæ•°ï¼Œ é€šè¿‡invokerä¸ªæ•°å¾ªç¯è®¡ç®—<code>totalWeight</code> æ€»æƒé‡ï¼Œè·å–ä¸€ä¸ª<strong>[0,totalWeight)</strong>åŒºé—´å†…çš„éšæœºæ•°ï¼Œå†è¿›è¡Œä¸€ä¸ªå‡æ³•è·å–å¯¹åº”çš„invokerã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="type">int</span> <span class="title function_">getWeight</span><span class="params">(Invoker&lt;?&gt; invoker, Invocation invocation)</span> &#123;</span><br><span class="line">   		<span class="comment">// é€šè¿‡å‚æ•°weightæŒ‡å®šæƒé‡</span></span><br><span class="line">       <span class="type">int</span> <span class="variable">weight</span> <span class="operator">=</span> invoker.getUrl().getMethodParameter(invocation.getMethodName(), <span class="string">&quot;weight&quot;</span>, <span class="number">100</span>);</span><br><span class="line">       <span class="keyword">if</span> (weight &gt; <span class="number">0</span>) &#123;</span><br><span class="line">           <span class="type">long</span> <span class="variable">timestamp</span> <span class="operator">=</span> invoker.getUrl().getParameter(<span class="string">&quot;remote.timestamp&quot;</span>, <span class="number">0L</span>);</span><br><span class="line">           <span class="keyword">if</span> (timestamp &gt; <span class="number">0L</span>) &#123;</span><br><span class="line">               <span class="type">int</span> <span class="variable">uptime</span> <span class="operator">=</span> (<span class="type">int</span>)(System.currentTimeMillis() - timestamp);</span><br><span class="line">             	<span class="comment">// è®¾ç½®é¢„çƒ­æ—¶é—´</span></span><br><span class="line">               <span class="type">int</span> <span class="variable">warmup</span> <span class="operator">=</span> invoker.getUrl().getParameter(<span class="string">&quot;warmup&quot;</span>, <span class="number">600000</span>);</span><br><span class="line">               <span class="keyword">if</span> (uptime &gt; <span class="number">0</span> &amp;&amp; uptime &lt; warmup) &#123;</span><br><span class="line">                   weight = calculateWarmupWeight(uptime, warmup, weight);</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> weight;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡getWeightæ–¹æ³•å¯ä»¥çœ‹åˆ°ï¼Œé»˜è®¤æƒé‡ä¸º100ï¼Œå¯ä»¥è‡ªå®šä¹‰æŒ‡å®šæƒé‡å’Œé¢„çƒ­æ—¶é—´ã€‚</p>
<h2 id="ä¸‰ã€RoundRobinLoadBalance"><a href="#ä¸‰ã€RoundRobinLoadBalance" class="headerlink" title="ä¸‰ã€RoundRobinLoadBalance"></a>ä¸‰ã€RoundRobinLoadBalance</h2><p>è½®è¯¢ï¼ŒæŒ‰ç…§å…¬çº¦ä¹‹åçš„æƒé‡è®¾ç½®è½®è¯¢æ¯”ç‡ã€‚å­˜åœ¨æ‰§è¡Œæ¯”è¾ƒæ…¢çš„æœåŠ¡æä¾›è€…å †ç§¯è¯·æ±‚çš„æƒ…å†µã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// ç¼“å­˜   key =æ¥å£å…¨ç±»å.æ–¹æ³•å      value = map&lt;æ¯ä¸ªinvokerçš„æ ‡è¯†ï¼ŒWeightedRoundRobin &gt;</span></span><br><span class="line">  <span class="keyword">private</span> ConcurrentMap&lt;String, ConcurrentMap&lt;String, WeightedRoundRobin&gt;&gt; methodWeightMap = <span class="keyword">new</span> <span class="title class_">ConcurrentHashMap</span>&lt;String, ConcurrentMap&lt;String, WeightedRoundRobin&gt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">AtomicBoolean</span> <span class="variable">updateLock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicBoolean</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">RECYCLE_PERIOD</span> <span class="operator">=</span> <span class="number">60000</span>; <span class="comment">// æ›´æ–°å‘¨æœŸ</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> &lt;T&gt; Invoker&lt;T&gt; <span class="title function_">doSelect</span><span class="params">(List&lt;Invoker&lt;T&gt;&gt; invokers, URL url, Invocation invocation)</span> &#123;</span><br><span class="line">      <span class="comment">/// ç»„è£…key = æ¥å£å…¨ç±»å.æ–¹æ³•å</span></span><br><span class="line">      <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> invokers.get(<span class="number">0</span>).getUrl().getServiceKey() + <span class="string">&quot;.&quot;</span> + invocation.getMethodName();</span><br><span class="line">      <span class="comment">// æ ¹æ®key ä»ç¼“å­˜ä¸­è·å–</span></span><br><span class="line">      ConcurrentMap&lt;String, WeightedRoundRobin&gt; map = methodWeightMap.get(key);</span><br><span class="line">      <span class="comment">// å¤„ç†æ˜¯ç©ºçš„æƒ…å†µï¼Œå¦‚æœä¸ºç©ºå°±åˆ›å»º ç„¶åå¡è¿›å»</span></span><br><span class="line">      <span class="keyword">if</span> (map == <span class="literal">null</span>) &#123;</span><br><span class="line">          methodWeightMap.putIfAbsent(key, <span class="keyword">new</span> <span class="title class_">ConcurrentHashMap</span>&lt;String, WeightedRoundRobin&gt;());</span><br><span class="line">          map = methodWeightMap.get(key);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="type">int</span> <span class="variable">totalWeight</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">      <span class="comment">//åˆå§‹åŒ–max ä¸ºlongæœ€å°å€¼</span></span><br><span class="line">      <span class="type">long</span> <span class="variable">maxCurrent</span> <span class="operator">=</span> Long.MIN_VALUE;</span><br><span class="line">      <span class="comment">// è·å–ç³»ç»Ÿå½“å‰æ—¶é—´</span></span><br><span class="line">      <span class="type">long</span> <span class="variable">now</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">      Invoker&lt;T&gt; selectedInvoker = <span class="literal">null</span>;</span><br><span class="line">      <span class="type">WeightedRoundRobin</span> <span class="variable">selectedWRR</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// éå†invokers</span></span><br><span class="line">      <span class="keyword">for</span> (Invoker&lt;T&gt; invoker : invokers) &#123;</span><br><span class="line"></span><br><span class="line">          <span class="comment">// å°†url è½¬æˆ èº«ä»½æ ‡è¯†</span></span><br><span class="line">          <span class="type">String</span> <span class="variable">identifyString</span> <span class="operator">=</span> invoker.getUrl().toIdentityString();</span><br><span class="line"></span><br><span class="line">          <span class="comment">// ä»mapä¸­è·å–</span></span><br><span class="line">          <span class="type">WeightedRoundRobin</span> <span class="variable">weightedRoundRobin</span> <span class="operator">=</span> map.get(identifyString);</span><br><span class="line">          <span class="comment">// è®¡ç®—æƒé‡</span></span><br><span class="line">          <span class="type">int</span> <span class="variable">weight</span> <span class="operator">=</span> getWeight(invoker, invocation);</span><br><span class="line">          <span class="keyword">if</span> (weight &lt; <span class="number">0</span>) &#123;<span class="comment">// å¦‚æœè®¡ç®—çš„æƒé‡å°äº0 ï¼Œ è®¾ç½®æˆ0</span></span><br><span class="line">              weight = <span class="number">0</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> (weightedRoundRobin == <span class="literal">null</span>) &#123;<span class="comment">// æ²¡æœ‰è·å–åˆ°ï¼Œè¯´æ˜æ²¡æœ‰ç¼“å­˜</span></span><br><span class="line">              weightedRoundRobin = <span class="keyword">new</span> <span class="title class_">WeightedRoundRobin</span>();<span class="comment">//åˆ›å»ºWeightedRoundRobinå¯¹è±¡</span></span><br><span class="line">              weightedRoundRobin.setWeight(weight);<span class="comment">// è®¾ç½®æƒé‡</span></span><br><span class="line">              <span class="comment">// å°†WeightedRoundRobin å¯¹è±¡å¡åˆ° mapä¸­</span></span><br><span class="line">              map.putIfAbsent(identifyString, weightedRoundRobin);</span><br><span class="line">              weightedRoundRobin = map.get(identifyString);</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="comment">//å¦‚æœå½“å‰è®¡ç®—çš„æƒé‡ä¸ä¹‹å‰ç¼“å­˜çš„æ¯”åŒ¹é…å°±è®¾ç½®æˆå½“å‰æƒé‡</span></span><br><span class="line">          <span class="keyword">if</span> (weight != weightedRoundRobin.getWeight()) &#123;</span><br><span class="line">              <span class="comment">//weight changed</span></span><br><span class="line">              weightedRoundRobin.setWeight(weight);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">// å°†æƒé‡å€¼è®¾ç½®åˆ°atomiclong ä¸­ current += weight</span></span><br><span class="line">          <span class="type">long</span> <span class="variable">cur</span> <span class="operator">=</span> weightedRoundRobin.increaseCurrent();</span><br><span class="line">          <span class="comment">// è®¾ç½®æœ€åä¿®æ”¹æ—¶é—´</span></span><br><span class="line">          weightedRoundRobin.setLastUpdate(now);</span><br><span class="line"></span><br><span class="line">          <span class="comment">// å¦‚æœå½“å‰æƒé‡ &gt; max</span></span><br><span class="line">          <span class="keyword">if</span> (cur &gt; maxCurrent) &#123;</span><br><span class="line">              maxCurrent = cur;<span class="comment">// max è®¾ç½®æˆèµ‹å€¼ä¸ºå½“å‰æƒé‡</span></span><br><span class="line">              selectedInvoker = invoker;</span><br><span class="line">              selectedWRR = weightedRoundRobin;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">// æ€»æƒé‡+ å½“å‰æƒé‡</span></span><br><span class="line">          totalWeight += weight;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// æ ¹æ®RECYCLE_PERIODæ—¶é—´ æ›´æ–°map ä¸€èˆ¬å‘ç”Ÿåœ¨æœåŠ¡æä¾›è€…æ•°é‡å˜æ›´</span></span><br><span class="line">      <span class="comment">// æ²¡æœ‰åœ¨ä¿®æ”¹çš„ &amp;&amp; å½“å‰æ‰€æœ‰çš„invoker åˆ—è¡¨å¤§å° ä¸ç­‰äº ç¼“å­˜é‡Œé¢çš„å¤§å°</span></span><br><span class="line">      <span class="keyword">if</span> (!updateLock.get() &amp;&amp; invokers.size() != map.size()) &#123;</span><br><span class="line">          <span class="keyword">if</span> (updateLock.compareAndSet(<span class="literal">false</span>, <span class="literal">true</span>)) &#123;<span class="comment">// cas æ“ä½œ</span></span><br><span class="line">              <span class="keyword">try</span> &#123;</span><br><span class="line">                  <span class="comment">// copy -&gt; modify -&gt; update reference</span></span><br><span class="line">                  ConcurrentMap&lt;String, WeightedRoundRobin&gt; newMap = <span class="keyword">new</span> <span class="title class_">ConcurrentHashMap</span>&lt;String, WeightedRoundRobin&gt;();</span><br><span class="line">                  newMap.putAll(map);<span class="comment">// å°†mapæ·»åŠ åˆ° newMapä¸­</span></span><br><span class="line">                  Iterator&lt;Entry&lt;String, WeightedRoundRobin&gt;&gt; it = newMap.entrySet().iterator();</span><br><span class="line">                  <span class="keyword">while</span> (it.hasNext()) &#123;</span><br><span class="line">                      Entry&lt;String, WeightedRoundRobin&gt; item = it.next();</span><br><span class="line">                      <span class="comment">// ç§»é™¤ 1åˆ†é’Ÿæ²¡æœ‰æ”¹åŠ¨è¿‡çš„</span></span><br><span class="line">                      <span class="keyword">if</span> (now - item.getValue().getLastUpdate() &gt; RECYCLE_PERIOD) &#123;</span><br><span class="line">                          it.remove();</span><br><span class="line">                      &#125;</span><br><span class="line">                  &#125;<span class="comment">// æ›¿æ¢æˆæ–°çš„</span></span><br><span class="line">                  methodWeightMap.put(key, newMap);</span><br><span class="line">              &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                  updateLock.set(<span class="literal">false</span>);</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (selectedInvoker != <span class="literal">null</span>) &#123;</span><br><span class="line">          <span class="comment">// å°†é€‰ä¸­çš„é‚£ä¸ªweightedRoundRobin é‡Œé¢çš„æƒé‡ï¼ˆcurrentï¼‰è®¾ç½®ä¸ºå½“å‰å€¼å‡å»æ€»æƒé‡</span></span><br><span class="line">          selectedWRR.sel(totalWeight); <span class="comment">// current -= totalWeight </span></span><br><span class="line">          <span class="keyword">return</span> selectedInvoker;<span class="comment">// è¿”å›é€‰ä¸­çš„é‚£ä¸ªinvoker</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/// æœ€åå°±æ˜¯é€‰æ‹©ç¬¬ä¸€ä¸ª</span></span><br><span class="line">      <span class="comment">// should not happen here</span></span><br><span class="line">      <span class="keyword">return</span> invokers.get(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>â€‹    è½®è¯¢ç®—æ³•é€šè¿‡ä¸æ–­æ›´æ–°<code>weightedRoundRobin</code> å¯¹è±¡ä¸­çš„<code>current</code>å­—æ®µæ¥è°ƒæ•´æ¥ä¸‹æ¥è°ƒç”¨è¦é€‰å–çš„invokerï¼Œå‡å¦‚æˆ‘ä»¬å°†æ‰€æœ‰invokerçš„æƒé‡è®¾ç½®ä¸ºç›¸åŒçš„å€¼ï¼Œé‚£ä¹ˆloadbalanceå°†ä¼šæŒ‰ç…§é¡ºåºçš„æ–¹å¼è¿›è¡Œè°ƒç”¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (selectedInvoker != <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="comment">// å°†é€‰ä¸­çš„é‚£ä¸ªweightedRoundRobin é‡Œé¢çš„æƒé‡ï¼ˆcurrentï¼‰è®¾ç½®ä¸ºå½“å‰å€¼å‡å»æ€»æƒé‡</span></span><br><span class="line">    selectedWRR.sel(totalWeight); <span class="comment">// current -= totalWeight </span></span><br><span class="line">    <span class="keyword">return</span> selectedInvoker;<span class="comment">// è¿”å›é€‰ä¸­çš„é‚£ä¸ªinvoker</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>currentWeightçš„æ›´æ–°æ˜¯å®ç°è½®è¯¢çš„å…³é”®å¤„ç†é€»è¾‘ã€‚</p>
<h2 id="å››ã€LeastActiveLoadBalance"><a href="#å››ã€LeastActiveLoadBalance" class="headerlink" title="å››ã€LeastActiveLoadBalance"></a>å››ã€LeastActiveLoadBalance</h2><p>â€‹    æœ€å°‘æ´»è·ƒè°ƒç”¨ç­–ç•¥ï¼Œåœ¨äº†è§£æœ€å°æ´»è·ƒè°ƒç”¨è´Ÿè½½å‡è¡¡ç­–ç•¥ä¹‹å‰éœ€è¦äº†è§£è´Ÿè½½å‡è¡¡ä¸­è·å–invokeræ´»è·ƒæ•°çš„æ–¹æ³•ã€‚å³é€šè¿‡<code>ActiveLimitFilter</code>è·å–çš„invokerçš„æ´»è·ƒæƒ…å†µã€‚</p>
<h3 id="com-alibaba-dubbo-rpc-RpcStatus"><a href="#com-alibaba-dubbo-rpc-RpcStatus" class="headerlink" title="com.alibaba.dubbo.rpc.RpcStatus"></a>com.alibaba.dubbo.rpc.RpcStatus</h3><p>è¿™é‡Œä¸åšè¯¦ç»†åˆ†æï¼Œéœ€è¦æ³¨æ„çš„æ˜¯åœ¨<code>RpcStatus</code>ä¸­ç»´æŠ¤äº†ä¸€ä¸ªåŸå­ç±»å‹çš„<code>active</code>å­—æ®µï¼Œç”¨æ¥è¡¨ç¤ºinvokerçš„å¹¶å‘æƒ…å†µã€‚</p>
<p>åœ¨invokerè¢«è°ƒç”¨çš„å‰åå¯¹å­—æ®µ<code>active</code>è¿›è¡Œæ“ä½œï¼Œå³ï¼š</p>
<p>invokerè°ƒç”¨å¼€å§‹ï¼Œé€šè¿‡<code>com.alibaba.dubbo.rpc.RpcStatus#beginCount</code>ä½¿active + 1</p>
<p>invokerè°ƒç”¨ç»“æŸï¼Œé€šè¿‡<code>com.alibaba.dubbo.rpc.RpcStatus#endCount</code>ä½¿active - 1</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> &lt;T&gt; Invoker&lt;T&gt; <span class="title function_">doSelect</span><span class="params">(List&lt;Invoker&lt;T&gt;&gt; invokers, URL url, Invocation invocation)</span> &#123;</span><br><span class="line">        <span class="comment">// Number of invokers</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> invokers.size();</span><br><span class="line">        <span class="comment">// æœ€æ´»è·ƒåˆå§‹å€¼æ˜¯-1</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">leastActive</span> <span class="operator">=</span> -<span class="number">1</span>; </span><br><span class="line">        <span class="comment">//å…·æœ‰ç›¸åŒçš„æœ€å°æ´»åŠ¨å€¼çš„è°ƒç”¨ç¨‹åºçš„æ•°é‡(leastActive)</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">leastCount</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span>[] leastIndexs = <span class="keyword">new</span> <span class="title class_">int</span>[length]; </span><br><span class="line">        <span class="comment">// æƒé‡å’Œ</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">totalWeight</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//åˆå§‹å€¼</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">firstWeight</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">      </span><br><span class="line">        <span class="type">boolean</span> <span class="variable">sameWeight</span> <span class="operator">=</span> <span class="literal">true</span>; </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">            Invoker&lt;T&gt; invoker = invokers.get(i);</span><br><span class="line">            <span class="comment">// è·å–å½“å‰è¿™ä¸ªinvokerå¹¶å‘æ•°</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">active</span> <span class="operator">=</span> RpcStatus.getStatus(invoker.getUrl(), invocation.getMethodName()).getActive(); </span><br><span class="line">            <span class="comment">// è·å–æƒé‡</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">afterWarmup</span> <span class="operator">=</span> getWeight(invoker, invocation); <span class="comment">// Weight</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// ç¬¬ä¸€ä¸ªå…ƒç´ çš„åæˆ–è€… å½“å‰invokerå¹¶å‘æ•° å°äº æœ€å°å¹¶å‘æ•°ï¼ˆåˆå§‹å€¼æ˜¯-1ï¼‰</span></span><br><span class="line">            <span class="keyword">if</span> (leastActive == -<span class="number">1</span> || active &lt; leastActive) &#123; </span><br><span class="line">                <span class="comment">// è®°å½•leastActive ä¸ºå½“å‰çš„æ´»è·ƒæ•°</span></span><br><span class="line">                leastActive = active;</span><br><span class="line">                <span class="comment">//é‡ç½®æœ€å°è®¡æ•°ï¼ŒåŸºäºå½“å‰æœ€å°è®¡æ•°é‡æ–°è®¡æ•°</span></span><br><span class="line">                leastCount = <span class="number">1</span>;</span><br><span class="line">                <span class="comment">//åœ¨0ä¸‹æ ‡å‡ºæ”¾å…¥è¿™ä¸ªç´¢å¼•</span></span><br><span class="line">                leastIndexs[<span class="number">0</span>] = i; <span class="comment">// Reset</span></span><br><span class="line">                <span class="comment">// æ€»æƒé‡å°±æ˜¯ å½“å‰invokerçš„æƒé‡</span></span><br><span class="line">                totalWeight = afterWarmup; </span><br><span class="line">                <span class="comment">//ç¬¬ä¸€ä¸ªæƒé‡</span></span><br><span class="line">                firstWeight = afterWarmup;</span><br><span class="line">                sameWeight = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (active == leastActive) &#123; <span class="comment">// å½“å‰invokerçš„æ´»è·ƒæ•° ä¸ leastActiveç›¸ç­‰</span></span><br><span class="line">                <span class="comment">// è®°å½•ç´¢å¼•ä½ç½®ï¼Œå…·æœ‰ç›¸åŒæœ€å°æ´»è·ƒæ•°çš„è®¡æ•°å™¨ +1</span></span><br><span class="line">                leastIndexs[leastCount++] = i;</span><br><span class="line">                <span class="comment">//æ€»æƒé‡ =  æ€»æƒé‡+å½“å‰æƒé‡</span></span><br><span class="line">                totalWeight += afterWarmup; <span class="comment">// Add this invoker&#x27;s weight to totalWeight.</span></span><br><span class="line">                <span class="keyword">if</span> (sameWeight &amp;&amp; i &gt; <span class="number">0</span></span><br><span class="line">                        &amp;&amp; afterWarmup != firstWeight) &#123;</span><br><span class="line">                    sameWeight = <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (leastCount == <span class="number">1</span>) &#123;<span class="comment">//å¦‚æœæˆ‘ä»¬æ°å¥½æœ‰ä¸€ä¸ªè°ƒç”¨ç¨‹åºå…·æœ‰æœ€å°‘çš„æ´»åŠ¨å€¼ï¼Œé‚£ä¹ˆç›´æ¥è¿”å›è¿™ä¸ªè°ƒç”¨ç¨‹åºã€‚</span></span><br><span class="line">            <span class="keyword">return</span> invokers.get(leastIndexs[<span class="number">0</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¦‚æœæ¯ä¸ªinvokeræœ‰ä¸åŒçš„æƒé‡ &amp;&amp;  totalWeight &gt; 0</span></span><br><span class="line">        <span class="keyword">if</span> (!sameWeight &amp;&amp; totalWeight &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// åœ¨totalWeight èŒƒå›´å†…éšæœºä¸€ä¸ªå€¼</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">offsetWeight</span> <span class="operator">=</span> random.nextInt(totalWeight) + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; leastCount; i++) &#123;</span><br><span class="line">                <span class="comment">// è·å–iä½ç½®çš„é‚£ä¸ªæœ€å°æ´»è·ƒ åœ¨invokers é‡Œé¢çš„ä½ç½®ä¿¡æ¯</span></span><br><span class="line">                <span class="type">int</span> <span class="variable">leastIndex</span> <span class="operator">=</span> leastIndexs[i];</span><br><span class="line">                <span class="comment">//offsetWeight - leastIndex ä½ç½®invokerçš„æƒé‡</span></span><br><span class="line">                offsetWeight -= getWeight(invokers.get(leastIndex), invocation);</span><br><span class="line">                <span class="comment">// offsetWeight å°äº0çš„è¯</span></span><br><span class="line">                <span class="keyword">if</span> (offsetWeight &lt;= <span class="number">0</span>)</span><br><span class="line">                    <span class="comment">// è¿”å›è¿™ä¸ªä½ç½®çš„è¿™ä¸ª</span></span><br><span class="line">                    <span class="keyword">return</span> invokers.get(leastIndex);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å…·æœ‰ç›¸åŒæƒé‡æˆ–è€…æ˜¯ æ€»æƒé‡=0 çš„è¯å°±å‡åŒ€è¿”å›</span></span><br><span class="line">        <span class="comment">// If all invokers have the same weight value or totalWeight=0, return evenly.</span></span><br><span class="line">        <span class="keyword">return</span> invokers.get(leastIndexs[random.nextInt(leastCount)]);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>æœ€å°æ´»è·ƒç®—æ³•å¾ˆå¥½ç†è§£ï¼Œç¬¬ä¸€ä¸ªåˆ¤æ–­é€»è¾‘<code>leastActive == -1 || active &lt; leastActive</code>ä¼šå¤„ç†ç¬¬ä¸€ä¸ªinvokeræˆ–è€…æ˜¯æœ€ä¸æ´»è·ƒçš„ä¸€ä¸ªinvokerï¼Œå¹¶æŠŠå®ƒå­˜å‚¨åˆ°æ•°ç»„ä¸‹æ ‡ä¸º0çš„ä½ç½®ä¸Šã€‚ä¹Ÿå°±æ˜¯å¾ªç¯è¿‡ç¨‹ä¸­ä¼šå¾—åˆ°ä¸€ä¸ª<code>leastIndexs</code>æ•°ç»„ï¼Œè®°å½•äº†å½“å‰æœ€ä¸æ´»è·ƒçš„invoker listã€‚</p>
<p>åé¢çš„å¤„ç†å°±æ˜¯åˆ¤æ–­å½“å‰çš„listä¸­æ˜¯å¦æœ‰å¤šä¸ªinvokeræˆ–è€…å­˜åœ¨ä¸åŒæƒé‡çš„æƒ…å†µï¼Œè¿™é‡Œçš„invokeré€‰å–å°±å’Œ<code>RandomLoadBalance</code>é€»è¾‘å®Œå…¨ä¸€è‡´ã€‚</p>
<h2 id="äº”ã€ConsistentHashLoadBalance"><a href="#äº”ã€ConsistentHashLoadBalance" class="headerlink" title="äº”ã€ConsistentHashLoadBalance"></a>äº”ã€ConsistentHashLoadBalance</h2><p>â€‹    åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¯ä»¥é€šè¿‡Hashç®—æ³•è®©å›ºå®šçš„ä¸€éƒ¨åˆ†è¯·æ±‚è½åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·æ¯å°æœåŠ¡å™¨å°±ä¼šå›ºå®šå¤„ç†ä¸€éƒ¨åˆ†è¯·æ±‚ï¼Œä»è€Œèµ·åˆ°è´Ÿè½½å‡è¡¡çš„ä½œç”¨ã€‚</p>
<p>â€‹    ä½†æ˜¯æ™®é€šçš„Hashç®—æ³•ç¼ºä¹ä¼¸ç¼©æ€§ï¼Œå½“æ–°å¢æˆ–è€…ä¸‹çº¿æœåŠ¡å™¨æœºå™¨æ—¶ï¼Œç®€å•é€šè¿‡æ•£åˆ—çš„æ–¹å¼å»è´Ÿè½½å‡è¡¡å°±ä¼šå¯¼è‡´åŸæœ‰çš„æ˜ å°„å…³ç³»å¤§é‡å¤±æ•ˆã€‚<strong>ä¸€è‡´æ€§Hash</strong>åˆ™é€šè¿‡Hashç¯è¿›è¡Œäº†ä¼˜åŒ–ä¿®æ”¹ã€‚</p>
<h3 id="ç®—æ³•åŸç†"><a href="#ç®—æ³•åŸç†" class="headerlink" title="ç®—æ³•åŸç†"></a>ç®—æ³•åŸç†</h3><p>é¦–å…ˆå‡è®¾å­˜åœ¨4å°æœåŠ¡å™¨åˆ†åˆ«ä¸ºIp1-4:</p>
<p><img src="https://magic-picgo.oss-cn-beijing.aliyuncs.com/hexoBlog/image-20230311165622760.png" alt="image-20230311165622760"></p>
<p>è®¡ç®—å››å°æœåŠ¡å™¨ipåœ°å€å¯¹åº”çš„Hashå€¼ï¼Œè®¡ç®—å‡ºæ¥çš„Hashå€¼æ—¶0ï½æœ€å¤§æ­£æ•´æ•°ä¹‹é—´çš„ä¸€ä¸ªå€¼ï¼Œå¯¹åº”hashç¯ä¸Šçš„ä½ç½®å¦‚ä¸Šå›¾æ‰€ç¤ºğŸ‘†</p>
<p>å½“ç”¨æˆ·åœ¨å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚æ—¶ï¼Œä¼šæ ¹æ®hashè®¡ç®—è·¯ç”±è§„åˆ™ï¼Œè®¡ç®—å‡ºä¸€ä¸ªHashå€¼ï¼Œç„¶åçœ‹è¿™ä¸ªHashå€¼è½åœ¨äº†Hashç¯çš„å“ªä¸ªåœ°æ–¹ï¼Œå†æ ¹æ®Hashå€¼åœ¨Hashç¯ä¸Šçš„ä½ç½®é¡ºæ—¶é’ˆæ‰¾åˆ°è·ç¦»æœ€è¿‘çš„IPä½œä¸ºè·¯ç”±IPã€‚</p>
<p>å¦‚å›¾ï¼š</p>
<p><img src="https://magic-picgo.oss-cn-beijing.aliyuncs.com/hexoBlog/image-20230311165650267.png" alt="image-20230311165650267"></p>
<p>å‡è®¾æ­¤æ—¶ip3æœºå™¨å®•æœº,é‚£ä¹ˆæ­¤æ—¶çš„è¯·æ±‚åˆ†å¸ƒæƒ…å†µåº”è¯¥æ˜¯è¿™æ ·çš„ğŸ‘‡ï¼š</p>
<p><img src="https://magic-picgo.oss-cn-beijing.aliyuncs.com/hexoBlog/image-20230311170323499.png" alt="image-20230311170323499"></p>
<p>åŸæœ¬çš„u1è¯·æ±‚ä¼šä»åŸæ¥çš„ip3æœºå™¨é‡æ–°åˆ†é…åˆ°ip4æœºå™¨ä¸Šï¼Œè€Œä¹‹å‰æ²¡æœ‰åˆ†é…åˆ°ip3æœºå™¨ä¸Šçš„è¯·æ±‚ä¸ä¼šå—åˆ°å½±å“ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬å¢åŠ äº†ä¸€ä¸ªip5çš„æœºå™¨ï¼Œè¿™ä¸ªæœºå™¨åœ¨hashç¯ä¸Šçš„ä½ç½®åœ¨ip2å’Œip3ä¹‹é—´ï¼Œé‚£ä¹ˆåœ¨ç¯ä¸Šçš„åˆ†å¸ƒæƒ…å†µåº”è¯¥å¦‚ä¸‹å›¾æ‰€ç¤ºğŸ‘‡ï¼š</p>
<p><img src="https://magic-picgo.oss-cn-beijing.aliyuncs.com/hexoBlog/image-20230311171214857.png" alt="image-20230311171214857"></p>
<p>æ–°å¢åŠ çš„ip5çš„æœºå™¨ä¼šåˆ†æ‘Šä¸€éƒ¨åˆ†ip3çš„æœºå™¨çš„è¯·æ±‚ï¼Œå¦‚æœu1çš„è¯·æ±‚åœ¨ip5å’Œip2ä¹‹é—´ï¼Œé‚£ä¹ˆè¯·æ±‚å°±ä¼šé‡æ–°åˆ†é…åˆ°ip5æœºå™¨ä¸Šå¤„ç†ã€‚</p>
<h3 id="ä¸€è‡´æ€§Hashçš„ç‰¹æ€§"><a href="#ä¸€è‡´æ€§Hashçš„ç‰¹æ€§" class="headerlink" title="ä¸€è‡´æ€§Hashçš„ç‰¹æ€§"></a>ä¸€è‡´æ€§Hashçš„ç‰¹æ€§</h3><ul>
<li><strong>å•è°ƒæ€§ï¼ˆMonotonicityï¼‰</strong>ï¼šå•è°ƒæ€§æŒ‡åœ¨æ–°æœåŠ¡å™¨åŠ å…¥åˆ°ç³»ç»Ÿä¸­æ—¶ï¼Œåº”å½“ä¿è¯åŸæœ‰çš„è¯·æ±‚å¯ä»¥è¢«æ˜ å°„åˆ°åŸæœ‰å’Œæ–°å¢çš„æœåŠ¡å™¨ä¸Šï¼Œè€Œä¸ä¼šæ˜ å°„åˆ°åŸæœ‰çš„å…¶ä»–æœåŠ¡å™¨ä¸Šã€‚</li>
<li><strong>åˆ†æ•£æ€§ï¼ˆSpreadï¼‰</strong>ï¼šåœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œå½“å®¢æˆ·ç«¯è¯·æ±‚æ—¶å¯èƒ½ä¸çŸ¥é“æ‰€æœ‰æœåŠ¡å™¨çš„å­˜åœ¨ï¼Œå¯èƒ½åªçŸ¥é“å…¶ä¸­ä¸€éƒ¨åˆ†æœåŠ¡å™¨ï¼Œä»å®¢æˆ·ç«¯çœ‹æ¥ï¼Œå®ƒçœ‹åˆ°çš„éƒ¨åˆ†æœåŠ¡å™¨ä¼šå½¢æˆä¸€ä¸ªå®Œæ•´çš„Hashç¯ã€‚å¦‚æœå¤šä¸ªå®¢æˆ·ç«¯éƒ½æŠŠéƒ¨åˆ†æœåŠ¡å™¨ä½œä¸ºä¸€ä¸ªå®Œæ•´Hashç¯ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šå¯¼è‡´åŒä¸€ä¸ªç”¨æˆ·çš„è¯·æ±‚è¢«è·¯ç”±åˆ°ä¸åŒçš„æœåŠ¡å™¨è¿›è¡Œå¤„ç†ã€‚è¿™ç§æƒ…å†µæ˜¾ç„¶æ˜¯åº”è¯¥é¿å…çš„ï¼Œå› ä¸ºå®ƒä¸èƒ½ä¿è¯åŒä¸€ä¸ªç”¨æˆ·çš„è¯·æ±‚è½åˆ°åŒä¸€å°æœåŠ¡å™¨ã€‚æ‰€è°“åˆ†æ•£æ€§æ˜¯æŒ‡ä¸Šè¿°æƒ…å†µå‘ç”Ÿçš„ä¸¥é‡ç¨‹åº¦ã€‚</li>
<li><strong>å¹³è¡¡æ€§ï¼ˆBalanceï¼‰</strong>ï¼šå¹³è¡¡æ€§æŒ‡è´Ÿè½½å‡è¡¡ï¼ŒæŒ‡å®¢æˆ·ç«¯Hashåçš„è¯·æ±‚åº”è¯¥èƒ½åˆ†æ•£åˆ°ä¸åŒçš„æœåŠ¡å™¨ä¸Šã€‚</li>
</ul>
<h3 id="è™šæ‹ŸèŠ‚ç‚¹"><a href="#è™šæ‹ŸèŠ‚ç‚¹" class="headerlink" title="è™šæ‹ŸèŠ‚ç‚¹"></a>è™šæ‹ŸèŠ‚ç‚¹</h3><p><img src="https://magic-picgo.oss-cn-beijing.aliyuncs.com/hexoBlog/image-20230311173641982.png" alt="image-20230311173641982"></p>
<p>å‡è®¾ç»è¿‡è®¡ç®—åçš„Hashå€¼åœ¨ç¯ä¸Šåˆ†å¸ƒä¸å‡åŒ€ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´ä¸Šå›¾çš„æƒ…å†µï¼Œä¼šä½¿å¾—ip1æœºå™¨å¤„ç†æ›´å¤šçš„è¯·æ±‚ï¼Œè€Œip2å’Œip3åªä¼šè´Ÿè´£å°‘é‡çš„è¯·æ±‚ï¼Œè¿™æ ·å°±å‡ºç°äº†ä¸€è‡´æ€§Hashçš„å€¾æ–œã€‚</p>
<p>è§£å†³ä¸€è‡´æ€§Hashå€¾æ–œé—®é¢˜çš„è§£å†³æ–¹å¼ä¸€ç§æ˜¯ç®€å•ç²—æš´çš„åŠ æœºå™¨è§£å†³ï¼Œä½†æ˜¯å¢åŠ æœºå™¨æ˜¯æœ‰æˆæœ¬çš„ï¼Œé‚£ä¹ˆå°±éœ€è¦è™šæ‹ŸèŠ‚ç‚¹æ¥è§£å†³ã€‚å¦‚å›¾ï¼Œæ¯å°æœºå™¨å¢åŠ ä¸€ä¸ªè™šæ‹ŸèŠ‚ç‚¹ä¹‹åçš„ä¸€è‡´æ€§Hashç¯å¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://magic-picgo.oss-cn-beijing.aliyuncs.com/hexoBlog/image-20230311174009199.png" alt="image-20230311174009199"></p>
<p>è¿™æ ·å°±ä½¿å¾—è¯·æ±‚ç›¸å¯¹å‡åŒ€çš„åˆ†å¸ƒåœ¨ä¸‰å°æœºå™¨ä¸Šã€‚</p>
<h3 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"> <span class="keyword">protected</span> &lt;T&gt; Invoker&lt;T&gt; <span class="title function_">doSelect</span><span class="params">(List&lt;Invoker&lt;T&gt;&gt; invokers, URL url, Invocation invocation)</span> &#123;</span><br><span class="line">     <span class="type">String</span> <span class="variable">methodName</span> <span class="operator">=</span> RpcUtils.getMethodName(invocation);</span><br><span class="line">     <span class="comment">// æ‹¼æ¥key</span></span><br><span class="line">     <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> invokers.get(<span class="number">0</span>).getUrl().getServiceKey() + <span class="string">&quot;.&quot;</span> + methodName;</span><br><span class="line"></span><br><span class="line">     <span class="comment">// è®¡ç®—hash</span></span><br><span class="line">     <span class="type">int</span> <span class="variable">identityHashCode</span> <span class="operator">=</span> System.identityHashCode(invokers);</span><br><span class="line"></span><br><span class="line">     <span class="comment">// æ ¹æ®key ä»ç¼“å­˜ä¸­è·å–ConsistentHashSelector</span></span><br><span class="line">     ConsistentHashSelector&lt;T&gt; selector = (ConsistentHashSelector&lt;T&gt;) selectors.get(key);</span><br><span class="line">     <span class="keyword">if</span> (selector == <span class="literal">null</span> || selector.identityHashCode != identityHashCode) &#123;</span><br><span class="line"></span><br><span class="line">         <span class="comment">// åˆ›å»ºConsistentHashSelector æ”¾å…¥ç¼“å­˜ä¸­</span></span><br><span class="line">         selectors.put(key, <span class="keyword">new</span> <span class="title class_">ConsistentHashSelector</span>&lt;T&gt;(invokers, methodName, identityHashCode));</span><br><span class="line">         <span class="comment">// è·å–æ–°çš„selector</span></span><br><span class="line">         selector = (ConsistentHashSelector&lt;T&gt;) selectors.get(key);</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">return</span> selector.select(invocation);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šä»£ç ä¸»è¦æ˜¯é€šè¿‡invokeræ¥è®¡ç®—è·å–å¯¹åº”çš„selectorï¼Œä¸»è¦çš„è´Ÿè½½å‡è¡¡é€»è¾‘åº”å½“éƒ½æ˜¯ç”±selectoræ¥å®ç°çš„ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//   ConsistentHashSelectoræ„é€ æ–¹æ³•</span></span><br><span class="line">ConsistentHashSelector(List&lt;Invoker&lt;T&gt;&gt; invokers, String methodName, <span class="type">int</span> identityHashCode) &#123;</span><br><span class="line">            <span class="comment">// è™šæ‹Ÿçš„invoker</span></span><br><span class="line">            <span class="built_in">this</span>.virtualInvokers = <span class="keyword">new</span> <span class="title class_">TreeMap</span>&lt;Long, Invoker&lt;T&gt;&gt;();</span><br><span class="line">            <span class="comment">// hashcode</span></span><br><span class="line">            <span class="built_in">this</span>.identityHashCode = identityHashCode;</span><br><span class="line">            <span class="comment">// è·å–url</span></span><br><span class="line">            <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> invokers.get(<span class="number">0</span>).getUrl();</span><br><span class="line"></span><br><span class="line">            <span class="comment">//è·å–hash.nodes ï¼Œç¼ºçœæ˜¯160 å¯ä»¥æŒ‡å®š</span></span><br><span class="line">            <span class="built_in">this</span>.replicaNumber = url.getMethodParameter(methodName, <span class="string">&quot;hash.nodes&quot;</span>, <span class="number">160</span>);</span><br><span class="line">            <span class="comment">// è·å–hash.arguments ç¼ºçœæ˜¯0 ç„¶åè¿›è¡Œåˆ‡å‰²</span></span><br><span class="line">            String[] index = Constants.COMMA_SPLIT_PATTERN.split(url.getMethodParameter(methodName, <span class="string">&quot;hash.arguments&quot;</span>, <span class="string">&quot;0&quot;</span>));</span><br><span class="line">            argumentIndex = <span class="keyword">new</span> <span class="title class_">int</span>[index.length];</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; index.length; i++) &#123;</span><br><span class="line">                argumentIndex[i] = Integer.parseInt(index[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (Invoker&lt;T&gt; invoker : invokers) &#123;</span><br><span class="line">                <span class="comment">// è·å–åœ°å€ åŒå±‚åµŒå¥—å¾ªç¯</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">address</span> <span class="operator">=</span> invoker.getUrl().getAddress();</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; replicaNumber / <span class="number">4</span>; i++) &#123;</span><br><span class="line">                    <span class="type">byte</span>[] digest = md5(address + i);</span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">h</span> <span class="operator">=</span> <span class="number">0</span>; h &lt; <span class="number">4</span>; h++) &#123;</span><br><span class="line">                        <span class="type">long</span> <span class="variable">m</span> <span class="operator">=</span> hash(digest, h);<span class="comment">//è®¡ç®—ä½ç½®</span></span><br><span class="line">                        virtualInvokers.put(m, invoker);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œä¸»è¦æ˜¯å¯¹æ¯ä¸ªmethodåˆ›å»ºä¸€ä¸ª<code>virtualInvokers</code>çš„treeMapç”¨æ¥å­˜å‚¨è™šæ‹ŸèŠ‚ç‚¹ï¼Œkeyå°±æ˜¯è®¡ç®—å‡ºæ¥çš„hashå€¼ï¼Œvalueå°±æ˜¯invokerã€‚</p>
<blockquote>
<p>  è¿™é‡Œçš„åŒå±‚å¾ªç¯çš„å…·ä½“ç®—æ³•ï¼š</p>
<p>  <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Consistent_hashing">https://en.wikipedia.org/wiki/Consistent_hashing</a></p>
</blockquote>
<p><code>ConsistentHashSelector</code>çš„<code>invoker()</code>æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Invoker&lt;T&gt; <span class="title function_">select</span><span class="params">(Invocation invocation)</span> &#123;</span><br><span class="line">          <span class="comment">// å°†å‚æ•°è½¬æˆkey</span></span><br><span class="line">          <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> toKey(invocation.getArguments());</span><br><span class="line">          <span class="type">byte</span>[] digest = md5(key);</span><br><span class="line">          <span class="keyword">return</span> selectForKey(hash(digest, <span class="number">0</span>));</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">private</span> String <span class="title function_">toKey</span><span class="params">(Object[] args)</span> &#123;</span><br><span class="line">          <span class="type">StringBuilder</span> <span class="variable">buf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">          <span class="keyword">for</span> (<span class="type">int</span> i : argumentIndex) &#123;</span><br><span class="line">              <span class="keyword">if</span> (i &gt;= <span class="number">0</span> &amp;&amp; i &lt; args.length) &#123;</span><br><span class="line">                  buf.append(args[i]);<span class="comment">// å‚æ•°</span></span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">return</span> buf.toString();</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">private</span> Invoker&lt;T&gt; <span class="title function_">selectForKey</span><span class="params">(<span class="type">long</span> hash)</span> &#123;</span><br><span class="line">        <span class="comment">//tailMap æ˜¯è¿”å›é”®å€¼å¤§äºæˆ–ç­‰äºkeyçš„é‚£éƒ¨åˆ† ï¼Œç„¶åå†å–ç¬¬ä¸€ä¸ª</span></span><br><span class="line">          Map.Entry&lt;Long, Invoker&lt;T&gt;&gt; entry = virtualInvokers.tailMap(hash, <span class="literal">true</span>).firstEntry();</span><br><span class="line">          <span class="keyword">if</span> (entry == <span class="literal">null</span>) &#123;<span class="comment">//å¦‚æœæ²¡æœ‰å–åˆ°çš„è¯å°±è¯´æ˜hashå°±æ˜¯æœ€å¤§çš„äº†ï¼Œä¸‹é¢é‚£ä¸ªå°±æ˜¯ treemap ç¬¬ä¸€ä¸ªäº†</span></span><br><span class="line">              entry = virtualInvokers.firstEntry();</span><br><span class="line">          &#125;<span class="comment">// è¿”å›å¯¹åº”çš„é‚£ä¸ªinvoker</span></span><br><span class="line">          <span class="keyword">return</span> entry.getValue();</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>
<p>ä¸»è¦æ˜¯é€šè¿‡<code>tailMap()</code>æ–¹æ³•æ‰¾åˆ°è¿”å›é”®å€¼å¤§äºæˆ–ç­‰äºkeyçš„éƒ¨åˆ†ï¼Œç„¶é€šè¿‡<code>firstEntry()</code>å–ç¬¬ä¸€ä¸ªã€‚</p>
<h2 id="å…­ã€åŸºäºæ‰©å±•æ¥å£å®ç°è‡ªå®šä¹‰è´Ÿè½½å‡è¡¡ç­–ç•¥"><a href="#å…­ã€åŸºäºæ‰©å±•æ¥å£å®ç°è‡ªå®šä¹‰è´Ÿè½½å‡è¡¡ç­–ç•¥" class="headerlink" title="å…­ã€åŸºäºæ‰©å±•æ¥å£å®ç°è‡ªå®šä¹‰è´Ÿè½½å‡è¡¡ç­–ç•¥"></a>å…­ã€åŸºäºæ‰©å±•æ¥å£å®ç°è‡ªå®šä¹‰è´Ÿè½½å‡è¡¡ç­–ç•¥</h2><p>â€‹     è‡ªå®šä¹‰æ‰©å±•å®ç°ï¼Œé¦–å…ˆéœ€è¦å®ç°LoadBalanceæ¥å£ï¼Œç”±äºDubboæœ¬èº«æä¾›äº†ä¸€ä¸ªæŠ½è±¡ç±»AbstractLoadBalanceï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥ç»§æ‰¿è¯¥ç±»å¹¶ä¸”å®ç°<code>doSelect()</code>æ–¹æ³•ï¼š<br><img src="https://magic-picgo.oss-cn-beijing.aliyuncs.com/hexoBlog/image-20230311182131266.png" alt="image-20230311182131266"></p>
<p>ä»¥ä¸Šï¼</p>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>liuchanglin</span>
                    </p>
                
                
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span><strong>æˆ‘æƒ­æºå®å‰‘ï¼Œåªä¸ºçœ‹å±±æ¥.</strong></span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/Java/"># Java</a>
                    
                        <a href="/tags/Dubbo/"># Dubbo</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>Â· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
            
            <a class="next" rel="next" href="/2023/02/05/Lag-Compensation-%E7%BD%91%E7%BB%9C%E6%B8%B8%E6%88%8F%E4%B8%AD%E7%9A%84%E5%BB%B6%E8%BF%9F%E8%A1%A5%E5%81%BF/">Lag Compensation - ç½‘ç»œæ¸¸æˆä¸­çš„å»¶è¿Ÿè¡¥å¿</a>
            
        </section>


    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>Â© liuchanglin | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>
</html>
